<!--
Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE
The complete set of authors may be found at http://polymer.github.io/AUTHORS
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS
-->

<!--
/**
 * @group Polymer Core Elements
 *
 * `core-header-panel` contains a header section and a content section. Special
 * support is provided for scrolling modes when one uses a core-toolbar or equivalent
 * for the header section.
 *
 * Example:
 *
 *     <core-header-panel>
 *       <core-toolbar>Header</core-toolbar>
 *       <div>Content goes here...</div>
 *     </core-header-panel>
 *
 * If you want to use other than `core-toolbar` for the header, add 
 * `core-header` class to that element.
 *
 * Example:
 *
 *     <core-header-panel>
 *       <div class="core-header">Header</div>
 *       <div>Content goes here...</div>
 *     </core-header-panel>
 *
 * There are four different modes of header and scrolling behaviors.
 *
 * `standard`: The header is a step above the panel. The header will consume the 
 * panel at the point of entry, preventing it from passing through to the 
 * opposite side.
 *
 * `waterfall`: Similar to standard mode, but header is initially presented as 
 * seamed with panel, but then separates to form the step.
 *
 * `waterfall-tall`: The header is initially taller (`tall` class is added to 
 * the header).  As the user scrolls, the header separates (forming an edge)
 * while condensing (`tall` class is removed from the header).
 *
 * `scroll`: The header keeps its seam with the panel, and is pushed off screen.
 *
 * @element core-header-panel
 * @homepage github.io
 */
-->

<link rel="import" href="../polymer/polymer.html">

<polymer-element name="core-header-panel" attributes="mode">

  <template>

    <link rel="stylesheet" href="core-header-panel.css">
    <link rel="stylesheet" href="../core-layout/core-layout.css">
    
    <div class="header-panel-container" core-flow="v" on-scroll="{{scroll}}">

      <content id="headerContent" select="core-toolbar, paper-appbar, .core-header"></content>

      <div id="mainContainer" core-flex on-scroll="{{scroll}}">
        <content id="mainContent" select="*"></content>
      </div>

    </div>

  </template>

  <script>

    Polymer('core-header-panel', {

      /**
       * Controls header and scrolling behavior. Options are
       * `standard`, `waterfall`, `waterfall-tall` and `scroll`.
       * Default is `standard`.
       *
       * `standard`: The header is a step above the panel. The header will consume the 
       * panel at the point of entry, preventing it from passing through to the 
       * opposite side.
       *
       * `waterfall`: Similar to standard mode, but header is initially presented as 
       * seamed with panel, but then separates to form the step.
       *
       * `waterfall-tall`: The header is initially taller (`tall` class is added to 
       * the header).  As the user scrolls, the header separates (forming an edge)
       * while condensing (`tall` class is removed from the header).
       *
       * `scroll`: The header keeps its seam with the panel, and is pushed off screen.
       *
       * @attribute mode
       * @type string
       * @default ''
       */
      mode: '',

      ready: function() {
        this.scroll();
      },

      modeChanged: function() {
        this.scroll();
      },

      get header() {
        return this.$.headerContent.getDistributedNodes()[0];
      },

      scroll: function() {
        var seamedMode = {'waterfall': 1, 'waterfall-tall': 1, 'scroll': 1}; 
        var tallMode = {'waterfall-tall': 1};
        var atTop = (this.$.mainContainer.scrollTop === 0);
        var header = this.header;
        if (header) {
          header.classList.toggle('seamed', atTop && seamedMode[this.mode]);
          if (tallMode[this.mode]) {
            header.classList.toggle('tall', atTop);
          }
        }
      }

    });

  </script>

</polymer-element>
